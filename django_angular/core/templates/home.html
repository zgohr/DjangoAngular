{% load angularjs %}
<!doctype html>
<html ng-app>
    <head>
        <script src="{{ STATIC_URL }}angular/js/angular-1.0.1.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.js"></script>
        <script src="{{ STATIC_URL }}bootstrap/js/bootstrap-typeahead.js"></script>
        <script src="{{ STATIC_URL }}core/js/app.js"></script>

        <link rel="stylesheet" href="{{ STATIC_URL }}core/css/app.css">
        <link rel="stylesheet" href="{{ STATIC_URL }}bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="{{ STATIC_URL }}bootstrap/css/bootstrap-responsive.min.css">
    </head>

    <body>
        <div>
            <label>Name:</label>
            <input type="text" ng-model="yourName" placeholder="Enter a name here">
            <hr>

            <div class="container" ng-controller="TraderCtrl">
                <div class="row">
                    <div class="span10">
                        <h1>Hello {% ng yourName %}!</h1>
                        <form name="orderForm"
                            class="form form-inline">

                            <input class="input-small typeahead"
                                type="text" 
                                ng-model="item" 
                                placeholder="item" required>
                            <div class="input-prepend">
                                <span class="add-on">g</span>
                                <input class="input-small"
                                    type="text" 
                                    ng-model="price"
                                    ng-pattern="gold"
                                    placeholder="price per" required>
                            </div>
                            <input class="input-small"
                                type="number"
                                min="0"
                                max="250"
                                ng-model="quantity" placeholder="quantity" required>
                            <input class="btn"
                                ng-disabled="orderForm.$invalid"
                                ng-click="placeBuyOrder()"
                                type="submit" value="Place Buy Order">
                            <input class="btn"
                                ng-click="placeSellOrder()"
                                ng-disabled=
                                    "orderForm.$invalid || !hasInventory(item, quantity)"
                                type="submit" value="Place Sell Order">
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="span8">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <td>Item</td>
                                    <td>Price</td>
                                    <td>Quantity</td>
                                    <td>Value</td>
                                    <td>Fills</td>
                                    <td>Inventory Value</td>
                                    <td>Actions</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="order in buyOrders" class="{% ng status(order) %}">
                                    <td>{% ng order.name %}</td>
                                    <td>{% ng order.price | number:4 %}</td>
                                    <td>{% ng order.quantity %}</td>
                                    <td>{% ng order.price * order.quantity | number:4 %}</td>
                                    <td>
                                        <input class="input-mini" type="number"
                                            min="0"
                                            max="order.quantity"
                                            ng-disabled="order.complete"
                                            ng-model="order.fills">
                                    </td>
                                    <td>{% ng inventoryValue(order) | number:4 %}</td>
                                    <td>
                                        <button ng-click="markComplete(order)"
                                            class="btn btn-mini">Complete</button>
                                        <button ng-click="deleteOrder(order)"
                                            ng-disabled="order.complete"
                                            class="btn btn-danger btn-mini">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div> <!-- table div -->
                    <div class="span3">
                        <p>Total buy value: <strong>{% ng buyOrderValue() | number:4 %}</strong></p>
                        <p>Total inventory value: <strong>{% ng inventoryValue() | number:4 %}</strong></p>
                    </div>
                </div> <!-- table row -->
            </div> <!-- ng-controller div -->
        </div>
    </body>
</html>
