{% load angularjs %}
<!doctype html>
<html ng-app>
    <head>
        <script src="{{ STATIC_URL }}angular/js/angular-1.0.1.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script src="{{ STATIC_URL }}core/js/app.js"></script>

        <link rel="stylesheet" href="{{ STATIC_URL }}core/css/app.css">
        <link rel="stylesheet" href="{{ STATIC_URL }}bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="{{ STATIC_URL }}bootstrap/css/bootstrap-responsive.min.css">
    </head>

    <body>
        <div>
            <label>Name:</label>
            <input type="text" ng-model="yourName" placeholder="Enter a name here">
            <hr>

            <div class="container" ng-controller="TraderCtrl">
                <div class="row">
                    <div class="span6">
                        <h1>Hello {% ng yourName %}!</h1>
                        <form class="form form-inline" ng-submit="addOrder()">
                            <input class="input-small" type="text" ng-model="orderItem" placeholder="item" required>
                            <div class="input-prepend">
                                <span class="add-on">$</span>
                                <input class="input-small" type="number" 
                                    min="0"
                                    ng-model="orderAmount"
                                    placeholder="amount" required>
                            </div>
                            <input class="input-small"
                                type="number"
                                min="-250"
                                max="250"
                                ng-model="orderQuantity" placeholder="quantity" required>
                            <input class="btn" type="submit" value="Place Order">
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="span8">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <td>Item</td>
                                    <td>Amount</td>
                                    <td>Quantity</td>
                                    <td>Order Value</td>
                                    <td>Fills</td>
                                    <td>Inventory Value</td>
                                    <td>Actions</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="order in orders" class="{% ng status(order) %}">
                                    <td>{% ng order.item %}</td>
                                    <td>{% ng order.amount | currency %}</td>
                                    <td>{% ng order.quantity %}</td>
                                    <td>{% ng orderValue(order) | currency %}</td>
                                    <td>
                                        <input class="input-mini" type="number"
                                            min="0"
                                            max="{% ng getAbsQuantity(order) %}"
                                            ng-disabled="order.complete"
                                            ng-model="order.fills" ng-change="fills(order)">
                                    </td>
                                    <td>{% ng inventoryValue(order) | currency %}</td>
                                    <td>
                                        <button ng-click="markComplete(order)"
                                            class="btn btn-mini">Complete</button>
                                        <button ng-click="deleteOrder(order)"
                                            ng-disabled="order.complete"
                                            class="btn btn-danger btn-mini">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div> <!-- table div -->
                    <div class="span3">
                        <p>Total order value: <strong>{% ng orderValue() | currency %}</strong></p>
                        <p>Total inventory value: <strong>{% ng inventoryValue() | currency %}</strong></p>
                    </div>
                </div> <!-- table row -->
            </div> <!-- ng-controller div -->
        </div>
    </body>
</html>
